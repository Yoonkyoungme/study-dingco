# 07. 신뢰할 수 없는 코드를 쓰면서 불변성 지키기

## 📝 핵심 내용

- 신뢰할 수 없는 코드와 소통할 때는 `방어적 복사`를 해야한다.
  - 신뢰할 수 없는 코드란 `카피-온-라이트`가 적용되니 않은 코드를 말한다.
- `방어적 복사`는 중첩된 내부 데이터까지 깊은 복사를 하는 것을 말한다.
- `방어적 복사`는 `카피-온-라이트`보다 비용이 크기 때문에 필요한 부분에서만 사용하는 것이 좋다.
  - 안전지대에서는 `카피-온-라이트`를 통해 구조적 공유를 하는 것이 더 효율적이다.

## ❣️ 느낀 점

- `방어적 복사`와 `카피-온-라이트`의 차이점에 대해 명확하게 알게된 것 같아 좋다. 특히 언제 사용해야 하는지에 대해 명쾌하게 정리된 부분이 좋았다.
- 얕은 복사와 깊은 복사 중에서 무조건 깊은 복사가 좋은 것이라고 생각했는데, 오히려 구조적 공유를 통해 효율적으로 불변성을 지킬 수 있다는 것을 알게되었다.
- 깊은 복사를 해주는 라이브러리 말고 내장 매서드가 있었다면 너무 좋았을 것 같다는 생각이 들었다.

## 🤔 궁금한 점

## 🚀 더 생각해볼 점

- 배열과 객체를 깊은 복사할 수 있는 util 함수를 함께 만들어 보면 어떨까?
