# chapter 9. 계층형 설계 2

> 코드를 모듈화하기 위해 추상화 벽을 만드는 법을 배웁니다.
> 좋은 인터페이스가 어떤 것이고, 어떻게 찾는지 알아봅시다.
> 설계가 이만하면 되었다고 할 수 있는 시점을 압니다.
> 왜 계층형 설계가 유지보수와 테스트, 재사용에 도움이 되는지 이해합니다.

## 추상화 벽

팀 간 책임을 명확하게 나누는 것

세부 구현을 감춘 함수로 이루어진 계층

추상화 벽에 있는 함수를 사용할 때는 세부 구현을 몰라도 함수를 사용할 수 있음

추상화 벽에 있는 함수를 사용하는 쪽에서는 자료구조를 몰라도 됨

쉽게 구현을 바꾸기 위해 → 오버엔지니어링 주의

코드를 읽고 쓰기 쉽게 만들기 위해 → 세부적인 것은 신경쓰지 않음

팀 간에 조율해야 할 것을 줄이기 위해

주어진 문제에 집중하기 위해

신경쓰지 않아도 되는 것을 다루는 것이 핵심

어느 부분을 신경쓰지 않도록 만들면 좋을까요?

코드 줄 수는 중요하지 않고 코드가 `적절한 구체화 수준과 일반화` 가 되어 있는지가 중요

## 작은 인터페이스

새로운 기능을 만들 때 하위 계층에 기능을 추가하거나 고치는 것보다 **상위 계층에 만드는 것**

인터페이스를 최소화하면 하위 계층에 불필요한 기능이 쓸데없이 커지는 것을 방지

새로운 기능 추가

1. 추상화 벽에 만들기 → 시스템 하위 계층 코드가 늘어남
2. 추상화 벽 위에 만들기 ✅

하위 계층을 고치지 않고 상위 계층에서 문제를 해결할 수 있음

로그를 기록하는 추가 기능 구현 → 로깅 함수는 어디에 위치해야할까?

장바구니에 제품을 담을 때 호출하는 핸들러 함수 → 사용자가 장바구니에 제품을 담는 의도가 정확히 반영되는 위치

추상화 벽을 작게 만들어야 하는 이유

- 추상화 벽에 코드가 많을수록 구현이 변경되었을 때 고쳐야할 것이 많음
- 추상화 벽에 있는 코드는 낮은 수준의 코드이므로 더 많은 버그가 있을 수 있음
- 낮은 수준의 코드는 이해하기 더 어려움
- 추상화 벽에 코드가 많을수록 팀 간 조율해야 할 것도 많아짐
- 추상화 벽에 인터페이스가 많으면 알아야 할 것이 많아 사용하기 어려움

## 편리한 계층

설계와 새로운 기능의 필요성 사이 어느 지점에 멈추게 되는데, 언제 멈춰야 할지 알려줌

호출 그래프의 구조는 3가지 중요한 비기능적 요구사항을 알려줌

- 테스트를 어떻게 할 것인지
- 재사용을 잘할 수 있는지
- 유지보수하기 어렵지 않은지

그래프의 가장 위에 있는 코드가 고치기 가장 쉬움

아래에 있을수록 고치기 어렵고, 테스트가 중요
